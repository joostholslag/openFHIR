{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "FHIRConnect Context Schema",
  "type": "object",
  "properties": {
    "engine": {
      "type": "string",
      "pattern": "^FHIRConnect/v[0-9]+\\.[0-9]+\\.[0-9]+$"
    },
    "type": {
      "type": "string",
      "enum": ["context"]
    },
    "metadata": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[A-Za-z0-9_.-]+$"
        },
        "version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+[a-z]?$"
        }
      },
      "required": ["name", "version"]
    },
    "spec": {
      "type": "object",
      "properties": {
        "system": {
          "type": "string",
          "enum": ["FHIR"]
        },
        "version": {
          "type": "string",
          "enum": ["R4"]
        }
      },
      "required": ["system", "version"]
    },
    "context": {
      "type": "object",
      "properties": {
        "profileUrl": {
          "type": "string",
          "format": "uri"
        },
        "templateId": {
          "type": "string",
          "pattern": "^[A-Za-z0-9_-]+$"
        },
        "archetypes": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[A-Z]+\\.[A-Za-z0-9_]+\\.v[0-9]+$"
          }
        },
        "extensions": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[A-Za-z0-9_-]+$"
          }
        },
        "start": {
          "type": "string",
          "pattern": "^[A-Z]+\\.[A-Za-z0-9_]+\\.v[0-9]+$"
        }
      },
      "required": ["profileUrl", "templateId", "archetypes", "extensions", "start"]
    }
  },
  "required": ["engine", "type", "metadata", "spec", "context"]
}
