engine: FHIRConnect/v0.0.1
type: model
metadata:
  name: service_request.v1
  version: 0.0.1a
spec:
  system: FHIR
  version: R4
  openEhrConfig:
    archetype: openEHR-EHR-INSTRUCTION.service_request.v1

followedBy:
  mappings:
    - name: "specimen identifier"
      with:
        fhir: "identifier"
        openehr: "laboratory_specimen_identifier"
        type: "IDENTIFIER"
    - name: "specimen collection"
      with:
        fhir: "collection"
        openehr: "$openEhrArchetype"
        type: "NONE"
      followedBy:
        mappings:
          - name: "specimen collection date time"
            with:
              fhir: "collected.as(DateTimeType)"
              openehr: "collection_date_time.date_time_value"
              type: "DATETIME"
          - name: "specimen collector"
            with:
              fhir: "collector.as(Reference).identifier" # if you don't explicitly cast to Reference, it will try to add a Resource
              openehr: "specimen_collector_identifier"
              type: "IDENTIFIER"